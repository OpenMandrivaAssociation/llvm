--- clang/include/clang/Driver/Options.td.fuseLd~	2015-07-11 00:25:44.000000000 +0200
+++ clang/include/clang/Driver/Options.td	2015-07-12 00:44:27.244707983 +0200
@@ -440,6 +440,7 @@ def fprofile_use : Flag<["-"], "fprofile
 def fprofile_use_EQ : Joined<["-"], "fprofile-use=">,
     Group<f_Group>, Flags<[DriverOption]>, MetaVarName<"<pathname>">,
     HelpText<"Use instrumentation data for profile-guided optimization. If pathname is a directory, it reads from <pathname>/default.profdata. Otherwise, it reads from file <pathname>.">;
+def fuse_ld_EQ : Joined<["-"], "fuse-ld=">, Group<f_Group>, HelpText<"Select the linker to be used.">;
 
 def fblocks : Flag<["-"], "fblocks">, Group<f_Group>, Flags<[CC1Option]>,
   HelpText<"Enable the 'blocks' language feature">;
@@ -593,6 +594,7 @@ def funsafe_math_optimizations : Flag<["
   Group<f_Group>;
 def fno_unsafe_math_optimizations : Flag<["-"], "fno-unsafe-math-optimizations">,
   Group<f_Group>;
+def fuse_ld_EQ : Joined<["-"], "fuse-ld=">, Group<f_Group>;
 def fassociative_math : Flag<["-"], "fassociative-math">, Group<f_Group>;
 def fno_associative_math : Flag<["-"], "fno-associative-math">, Group<f_Group>;
 def freciprocal_math :
--- clang/lib/Driver/ToolChain.cpp.fuseLd~	2015-06-19 23:36:47.000000000 +0200
+++ clang/lib/Driver/ToolChain.cpp	2015-07-12 00:43:10.134955874 +0200
@@ -184,6 +184,18 @@ std::string ToolChain::GetFilePath(const
 }
 
 std::string ToolChain::GetProgramPath(const char *Name) const {
+  if(!strcmp(Name, "ld")) {
+    // Handle -fuse-ld=XXX the way gcc does
+    if (Arg *A = Args.getLastArg(options::OPT_fuse_ld_EQ)) {
+      StringRef Value = A->getValue();
+      if(Value.empty())
+        return D.GetProgramPath(Name, *this);
+      const char *suffix = Value.str().c_str();
+      char *newName = (char *) alloca(strlen(Name) + strlen(suffix) + 2);
+      sprintf(newName, "%s.%s", Name, suffix);
+      return D.GetProgramPath(newName, *this);
+    }
+  }
   return D.GetProgramPath(Name, *this);
 }
 
